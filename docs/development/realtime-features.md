# Real-time —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

## –û–±–∑–æ—Ä

–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Socket.IO, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø–æ–ª—É—á–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîî –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. **–ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–æ–≤
2. **–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º, –æ—Ç–≥—Ä—É–∑–∫–∞–º, –¥–æ—Å—Ç–∞–≤–∫–µ
3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∞—Å–∞–º–∏** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–∏–∑–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - –≤–∞–∂–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏

### üîä –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

- **–ù–æ–≤—ã–π –∑–∞–∫–∞–∑** - –¥–≤–æ–π–Ω–æ–π –≤—ã—Å–æ–∫–∏–π —Å–∏–≥–Ω–∞–ª (–ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ)
- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞** - –º–µ–ª–æ–¥–∏—á–Ω–æ–µ —Ç—Ä–∏–æ –Ω–æ—Ç (C-E-G)  
- **–ù–∏–∑–∫–∏–µ –∑–∞–ø–∞—Å—ã** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏–π –¥–≤–æ–π–Ω–æ–π —Å–∏–≥–Ω–∞–ª
- **–û—à–∏–±–∫–∏** - –Ω–∏–∑–∫–∏–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª

### üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ native —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–∞–∂–µ –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É
- üü° **–ñ–µ–ª—Ç—ã–π** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º:

1. **–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –≥–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
2. **–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –≤–∫–ª/–≤—ã–∫–ª –∑–≤—É–∫–∏
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ native —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ö–æ–Ω—Ç–µ–∫—Å—Ç Socket.IO

```tsx
import { useSocket } from '../contexts/SocketContext'

const MyComponent = () => {
  const { socket, isConnected, on, off, emit } = useSocket()
  
  useEffect(() => {
    const handleNewOrder = (data) => {
      console.log('–ù–æ–≤—ã–π –∑–∞–∫–∞–∑:', data)
    }
    
    on('order:new', handleNewOrder)
    
    return () => {
      off('order:new', handleNewOrder)  
    }
  }, [on, off])
  
  return <div>–°—Ç–∞—Ç—É—Å: {isConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ' : '–û—Ç–∫–ª—é—á–µ–Ω–æ'}</div>
}
```

### –•—É–∫–∏ –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```tsx
import { useDashboardRealTime, useOrdersRealTime } from '../hooks/useRealTimeUpdates'

// –î–ª—è –¥–∞—à–±–æ—Ä–¥–∞
const Dashboard = () => {
  const loadData = () => {
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  }
  
  useDashboardRealTime(loadData)
  
  return <div>Dashboard content</div>
}

// –î–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–∫–∞–∑–æ–≤
const OrdersPage = () => {
  const refreshOrders = () => {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
  }
  
  useOrdersRealTime(refreshOrders)
  
  return <div>Orders content</div>
}
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—É–∫–∏

- `useDashboardRealTime(onUpdate)` - –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
- `useOrdersRealTime(onUpdate)` - –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–∫–∞–∑–æ–≤  
- `useProductsRealTime(onUpdate)` - –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
- `useStoresRealTime(onUpdate)` - –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤
- `useUsersRealTime(onUpdate)` - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –°–æ–±—ã—Ç–∏—è Socket.IO

### –°–æ–±—ã—Ç–∏—è –∑–∞–∫–∞–∑–æ–≤
- `order:new` - –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
- `order:updated` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `order:payment_confirmed` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `order:rejected` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞

### –°–æ–±—ã—Ç–∏—è —Ç–æ–≤–∞—Ä–æ–≤
- `product:created` - –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
- `product:stock_low` - –º–∞–ª–æ —Ç–æ–≤–∞—Ä–∞ (‚â§10 —à—Ç)
- `product:out_of_stock` - —Ç–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è

### –°–æ–±—ã—Ç–∏—è –º–∞–≥–∞–∑–∏–Ω–æ–≤
- `store:created` - –Ω–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω
- `store:updated` - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–∞–≥–∞–∑–∏–Ω–µ

### –°–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `user:new_registration` - –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `user:role_changed` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `admin:broadcast` - —Ä–∞—Å—Å—ã–ª–∫–∞ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–î–ª—è —Ä–∞–±–æ—Ç—ã real-time —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Socket.IO —Å–µ—Ä–≤–µ—Ä:

```javascript
// –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ backend
const io = new Server(httpServer, {
  cors: {
    origin: process.env.FRONTEND_URL,
    credentials: true
  }
})

// –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
io.use((socket, next) => {
  const token = socket.handshake.auth.token
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞...
  next()
})

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
io.on('connection', (socket) => {
  console.log('Admin connected:', socket.userId)
  
  // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ –∞–¥–º–∏–Ω–æ–≤
  socket.join('admins')
  
  // –≠–º–∏—Ç —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
  socket.on('order:created', (data) => {
    io.to('admins').emit('order:new', data)
  })
})
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
VITE_SOCKET_URL=http://82.147.84.78:3001  # URL Socket.IO —Å–µ—Ä–≤–µ—Ä–∞
```

## –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ Socket.IO —Å–æ–±—ã—Ç–∏–π –≤–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

```javascript
localStorage.debug = 'socket.io-client:*'
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–¥–æ 5)
- –£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- –û—á–∏—Å—Ç–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç spam-–∞—Ç–∞–∫ —á–µ—Ä–µ–∑ rate limiting
