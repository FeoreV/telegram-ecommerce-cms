# Security Scripts Documentation

–ù–∞–±–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. `check-security-config.sh`
**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É
source .env && ./scripts/security/check-security-config.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ JWT Secrets (–Ω–∞–ª–∏—á–∏–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ 32 —Å–∏–º–≤–æ–ª–∞)
- ‚úÖ Database configuration (–ø–∞—Ä–æ–ª–∏ –Ω–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ Redis configuration –∏ –ø–∞—Ä–æ–ª–∏
- ‚úÖ CA Password (–º–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ Vault configuration (multi-key –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- ‚úÖ Session & CSRF secrets
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ .env —Ñ–∞–π–ª (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 600)
- ‚úÖ .env –≤ .gitignore
- ‚úÖ –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö (npm audit)

**–ö–æ–¥—ã –≤—ã—Ö–æ–¥–∞:**
- `0` - –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã –∏–ª–∏ —Ç–æ–ª—å–∫–æ warnings
- `1` - –ù–∞–π–¥–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

---

### 2. `generate-secrets.sh`
**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤**

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å
./scripts/security/generate-secrets.sh

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª
./scripts/security/generate-secrets.sh > .env.generated
cat .env.generated >> .env
rm .env.generated
```

**–ß—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è:**
- JWT_SECRET (48 –±–∞–π—Ç, base64)
- JWT_REFRESH_SECRET (48 –±–∞–π—Ç, base64)
- CA_PASSWORD (24 –±–∞–π—Ç–∞, base64)
- SESSION_SECRET (48 –±–∞–π—Ç, base64)
- CSRF_SECRET (48 –±–∞–π—Ç, base64)
- DB_PASSWORD (24 –±–∞–π—Ç–∞, base64)
- REDIS_PASSWORD (24 –±–∞–π—Ç–∞, base64)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** OpenSSL

---

### 3. `scan-for-secrets.sh`
**–°–∫–∞–Ω–µ—Ä —É—Ç–µ—á–µ–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤**

–°–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–ª—É—á–∞–π–Ω–æ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ credentials.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/security/scan-for-secrets.sh
```

**–ß—Ç–æ –∏—â–µ—Ç:**
- API Keys (—Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã)
- Tokens (access tokens, secret tokens)
- Passwords (—è–≤–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ)
- Private Keys (RSA, SSH keys)
- AWS Credentials (Access Key ID, Secret Access Key)
- GitHub Tokens
- Stripe Keys
- Database URLs —Å –ø–∞—Ä–æ–ª—è–º–∏
- .env —Ñ–∞–π–ª—ã –≤ git
- –°–µ–∫—Ä–µ—Ç—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ git (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∫–æ–º–º–∏—Ç–æ–≤)

**–°–∫–∞–Ω–∏—Ä—É–µ–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
- `backend/src`
- `bot/src`
- `frontend/src`
- `config/`

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**
- test/spec —Ñ–∞–π–ª—ã
- example/mock/fixture —Ñ–∞–π–ª—ã
- node_modules, dist, build

**–ö–æ–¥—ã –≤—ã—Ö–æ–¥–∞:**
- `0` - –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- `1` - –ù–∞–π–¥–µ–Ω—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ç–µ—á–∫–∏

---

### 4. `setup-git-hooks.sh`
**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git Hooks**

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫–æ–º–º–∏—Ç–∞—Ö.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
./scripts/security/setup-git-hooks.sh
```

**–ß—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è:**
- Pre-commit hook –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - –°–µ–∫—Ä–µ—Ç–æ–≤ –≤ staged —Ñ–∞–π–ª–∞—Ö
  - .env —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ–º–º–∏—Ç–µ
  - Hardcoded credentials
  - Debug –∫–æ–¥–∞ (console.log)

**–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
–ü—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º `git commit`.

**–ü—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
git commit --no-verify
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```bash
# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
./scripts/security/generate-secrets.sh > .env

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
source .env && ./scripts/security/check-security-config.sh

# 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ git hooks
./scripts/security/setup-git-hooks.sh

# 4. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
./scripts/security/scan-for-secrets.sh
```

### –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
source .env && ./scripts/security/check-security-config.sh

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ–∫—Ä–µ—Ç—ã
./scripts/security/scan-for-secrets.sh

# Audit –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
cd backend && npm audit
cd ../bot && npm audit
cd ../frontend && npm audit
```

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `setup-git-hooks.sh` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `generate-secrets.sh` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è .env —Ñ–∞–π–ª–∞
3. ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `scan-for-secrets.sh`

### –ü–µ—Ä–µ–¥ production deployment:
1. ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `check-security-config.sh`
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã >= –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `npm audit` –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Vault —Å multi-key sharing (key-shares >= 5)

### CI/CD Integration:
–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à CI/CD –ø–∞–π–ø–ª–∞–π–Ω:

```yaml
# –ü—Ä–∏–º–µ—Ä –¥–ª—è GitHub Actions
- name: Security Check
  run: |
    source .env.ci && ./scripts/security/check-security-config.sh
    ./scripts/security/scan-for-secrets.sh
    npm audit --audit-level=high
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "JWT_SECRET –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
**–†–µ—à–µ–Ω–∏–µ:**
```bash
export JWT_SECRET="$(openssl rand -base64 32)"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "chmod: command not found" (Windows)
**–†–µ—à–µ–Ω–∏–µ:**
- –ù–∞ Windows –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Git Bash –∏–ª–∏ WSL
- –ò–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ chmod - —Å–∫—Ä–∏–ø—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –ü—Ä–æ–±–ª–µ–º–∞: "openssl: command not found"
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Ubuntu/Debian
sudo apt-get install openssl

# macOS
brew install openssl

# Windows
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Git Bash (openssl —É–∂–µ –≤–∫–ª—é—á–µ–Ω)
```

### –ü—Ä–æ–±–ª–µ–º–∞: Git hook –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ hook
./scripts/security/setup-git-hooks.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
ls -la .git/hooks/pre-commit

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º: -rwxr-xr-x
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [SECURITY_DEPLOYMENT_GUIDE.md](../../SECURITY_DEPLOYMENT_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- [SECURITY_FIXES_FINAL_REPORT.md](../../SECURITY_FIXES_FINAL_REPORT.md) - –û—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE/SANS Top 25](https://cwe.mitre.org/top25/)

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
1. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π issue**
2. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –∫–æ–º–∞–Ω–¥–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: security@your-company.com
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏

---

*–í–µ—Ä—Å–∏—è: 1.0 | –û–±–Ω–æ–≤–ª–µ–Ω–æ: 3 –æ–∫—Ç—è–±—Ä—è 2025*

